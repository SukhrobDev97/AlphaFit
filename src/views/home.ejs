<%- include('includes/header') %>

<link rel="stylesheet" type="text/css" href="/css/home.css" />

<body>
  <% if(member) { %>
    <!-- Admin Home Page (when logged in) -->
    <div class="admin-layout">
      <!-- Sidebar -->
      <aside class="admin-sidebar">
        <div class="sidebar-header">
          <h2 class="sidebar-logo">Alpha<span class="logo-accent">Fit</span></h2>
        </div>
        <nav class="sidebar-nav">
          <a href="/admin" class="nav-item active">
            <span class="nav-label">Home</span>
            <span class="nav-indicator"></span>
          </a>
          <a href="/admin/product/all" class="nav-item">
            <span class="nav-label">Products</span>
          </a>
          <a href="/admin/user/all" class="nav-item">
            <span class="nav-label">Users</span>
          </a>
          <a href="/admin/dashboard" class="nav-item">
            <span class="nav-label">Dashboard</span>
          </a>
          <a href="/admin/logout" class="nav-item" onclick="return confirm('Do you want to logout?')">
            <span class="nav-label">Logout</span>
          </a>
        </nav>
      </aside>

      <!-- Main Content -->
      <main class="admin-main">
        <div class="admin-content">
          <h1 class="page-title">Admin Home</h1>
          
          <!-- KPI Cards Grid -->
          <div class="kpi-grid" id="kpiGrid">
            <!-- Loading State -->
            <div class="loading-state" id="loadingState">
              <div class="loading-spinner"></div>
              <p>Loading statistics...</p>
            </div>

            <!-- Error State -->
            <div class="error-state" id="errorState" style="display: none;">
              <p>Failed to load statistics. Please try again.</p>
              <button class="retry-btn" onclick="loadStats()">Retry</button>
            </div>

            <!-- KPI Cards -->
            <div class="kpi-cards-container" id="kpiCardsContainer" style="display: none;">
              <!-- Today's Revenue -->
              <div class="kpi-card">
                <h3 class="kpi-title">Today's Revenue</h3>
                <div class="kpi-value" id="todayRevenue">₩0</div>
                <a href="#" class="kpi-link">View details →</a>
              </div>

              <!-- Today's Orders -->
              <div class="kpi-card">
                <h3 class="kpi-title">Today's Orders</h3>
                <div class="kpi-value" id="todayOrders">0 orders</div>
                <a href="#" class="kpi-link">View details →</a>
              </div>

              <!-- Active Products -->
              <div class="kpi-card">
                <h3 class="kpi-title">Active Products</h3>
                <div class="kpi-value" id="activeProducts">0</div>
                <a href="#" class="kpi-link">View details →</a>
              </div>

              <!-- Active Users -->
              <div class="kpi-card">
                <h3 class="kpi-title">Active Users</h3>
                <div class="kpi-value" id="activeUsers">0</div>
                <a href="#" class="kpi-link">View details →</a>
              </div>
            </div>
          </div>

          <!-- Today Activity Section -->
          <% 
            const activityData = typeof activity !== 'undefined' ? activity : [];
            const alertsData = typeof alerts !== 'undefined' ? alerts : [];
          %>
          <%- include('partials/today-activity', { activity: activityData }) %>

          <!-- System Alerts Section -->
          <%- include('partials/system-alerts', { alerts: alertsData }) %>
        </div>
      </main>
    </div>
  <% } else { %>
    <!-- Admin Access Gate (when not logged in) -->
    <div class="admin-access-gate">
      <div class="gate-content">
        <h1 class="gate-logo">
          <span class="logo-alpha">Alpha</span><span class="logo-fit">Fit.</span>
        </h1>
        <p class="gate-subtitle">Nutrition Management System</p>
        <a href="/admin/login" class="gate-button">Admin Login</a>
        <p class="gate-footer">Authorized personnel only</p>
      </div>
    </div>
  <% } %>

  <script type="text/javascript" src="/js/home.js"></script>
</body>

<%- include('includes/footer') %>
