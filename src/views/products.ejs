<%- include('includes/header') %>

<link rel="stylesheet" type="text/css" href="/css/products.css" />

<body>
  <div class="admin-layout">
    <!-- Sidebar -->
    <aside class="admin-sidebar">
      <div class="sidebar-header">
        <h2 class="sidebar-logo">Alpha<span class="logo-accent">Fit</span></h2>
      </div>
      <nav class="sidebar-nav">
        <a href="/admin" class="nav-item">
          <span class="nav-label">Home</span>
        </a>
        <a href="/admin/product/all" class="nav-item active">
          <span class="nav-label">Products</span>
          <span class="nav-indicator"></span>
        </a>
        <a href="/admin/user/all" class="nav-item">
          <span class="nav-label">Users</span>
        </a>
        <a href="/admin/dashboard" class="nav-item">
          <span class="nav-label">Dashboard</span>
        </a>
        <a href="/admin/logout" class="nav-item" onclick="return confirm('Do you want to logout?')">
          <span class="nav-label">Logout</span>
        </a>
      </nav>
    </aside>

    <!-- Main Content -->
    <main class="admin-main">
      <div class="admin-content">
        <!-- Page Header -->
        <div class="page-header">
          <div class="header-content">
            <div>
              <h1 class="page-title">Products</h1>
              <p class="page-subtitle">Manage products, stock and status</p>
            </div>
            <button class="btn-new-product" id="new-product-btn">
              + New Product
            </button>
          </div>
        </div>

        <!-- Products Table Card -->
        <div class="products-card">
          <table class="products-table">
            <thead>
              <tr>
                <th>T/r</th>
                <th>Product Name</th>
                <th>Product Type</th>
                <th>Product Volume</th>
                <th>Product Price</th>
                <th>Product Left Count</th>
                <th>Status</th>
              </tr>
            </thead>
            <tbody>
              <% products.map(function(value, key){ %>
                <tr>
                  <td><%= key + 1 %></td>
                  <td><%= value.productName %></td>
                  <td><%= value.productCollection %></td>
                  <td><%= value.productCollection === "VITAMINS" ? value.productVolume : value.productSize %></td>
                  <td>â‚©<%= value.productPrice.toLocaleString() %></td>
                  <td><%= value.productLeftCount %></td>
                  <td>
                    <select class="status-select new-product-status status-<%= value.productStatus.toLowerCase() %>" id="<%= value._id %>">
                      <option value="PAUSE" <%= value.productStatus === "PAUSE" ? 'selected' : '' %>>PAUSE</option>
                      <option value="PROCESS" <%= value.productStatus === "PROCESS" ? 'selected' : '' %>>PROCESS</option>
                      <option value="DELETE" <%= value.productStatus === "DELETE" ? 'selected' : '' %>>DELETE</option>
                    </select>
                  </td>
                </tr>
              <% }) %>
            </tbody>
          </table>
        </div>
      </div>
    </main>
  </div>

  <!-- Slide-over Panel for New Product -->
  <div class="slide-over-backdrop" id="slide-over-backdrop"></div>
  <div class="slide-over-panel" id="slide-over-panel">
    <div class="panel-header">
      <h2 class="panel-title">Add New Product</h2>
      <button class="panel-close" id="panel-close">&times;</button>
    </div>

    <form 
      onsubmit="return validateForm()"
      action="/admin/product/create"
      method="POST"
      class="panel-form"
      enctype="multipart/form-data"
    >
      <!-- Basic Info Section -->
      <div class="form-section">
        <h3 class="section-title">Basic Info</h3>
        
        <div class="form-group">
          <label class="form-label">Product Name</label>
          <input
            type="text"
            placeholder="Enter product name"
            name="productName"
            class="form-input product-name"
            required
          />
        </div>

        <div class="form-row">
          <div class="form-group">
            <label class="form-label">Product Type</label>
            <select class="form-select product-collection" name="productCollection" required>
              <option value="DISH" selected>Dish</option>
              <option value="SUPPLEMENT">Supplement</option>
              <option value="DESSERT">Dessert</option>
              <option value="VITAMINS">Vitamins</option>
              <option value="OTHER">Other</option>
            </select>
          </div>

          <div class="form-group" id="product-collection">
            <label class="form-label">Dish Volume</label>
            <select class="form-select product-size" name="productSize">
              <option value="SMALL">Small</option>
              <option value="NORMAL" selected>Normal</option>
              <option value="LARGE">Large</option>
              <option value="SET">Set</option>
            </select>
          </div>

          <div class="form-group" id="product-volume" style="display: none">
            <label class="form-label">Vitamins Volume</label>
            <select class="form-select product-volume" name="productVolume">
              <option value="1" selected>pcs</option>
            </select>
          </div>
        </div>
      </div>

      <!-- Pricing & Stock Section -->
      <div class="form-section">
        <h3 class="section-title">Pricing & Stock</h3>
        
        <div class="form-row">
          <div class="form-group">
            <label class="form-label">Product Price</label>
            <input
              type="number"
              placeholder="Enter price"
              name="productPrice"
              class="form-input product-price"
              required
            />
          </div>
          <div class="form-group">
            <label class="form-label">Product Left Count</label>
            <input
              type="number"
              placeholder="Enter count"
              name="productLeftCount"
              class="form-input product-left-count"
              required
            />
          </div>
        </div>
      </div>

      <!-- Description Section -->
      <div class="form-section">
        <h3 class="section-title">Description</h3>
        <div class="form-group">
          <label class="form-label">Product Description</label>
          <textarea 
            name="productDesc" 
            class="form-textarea product-desc"
            placeholder="Enter product description"
            rows="4"
          ></textarea>
        </div>
      </div>

      <!-- Images Section -->
      <div class="form-section">
        <h3 class="section-title">Images</h3>
        <div class="images-grid">
          <div class="image-upload-box">
            <img src="/img/upload.svg" class="upload-preview" id="image-section-1" />
            <input
              type="file"
              name="productImages"
              class="image-upload-input image-one"
              accept="image/jpeg,image/jpg,image/png"
              required
              onchange="prewievFileHandler(this,1)"
            />
          </div>
          <div class="image-upload-box">
            <img src="/img/upload.svg" class="upload-preview" id="image-section-2" />
            <input
              type="file"
              name="productImages"
              class="image-upload-input image-two"
              accept="image/jpeg,image/jpg,image/png"
              onchange="prewievFileHandler(this,2)"
            />
          </div>
          <div class="image-upload-box">
            <img src="/img/upload.svg" class="upload-preview" id="image-section-3" />
            <input
              type="file"
              name="productImages"
              class="image-upload-input image-three"
              accept="image/jpeg,image/jpg,image/png"
              onchange="prewievFileHandler(this,3)"
            />
          </div>
          <div class="image-upload-box">
            <img src="/img/upload.svg" class="upload-preview" id="image-section-4" />
            <input
              type="file"
              name="productImages"
              class="image-upload-input image-four"
              accept="image/jpeg,image/jpg,image/png"
              onchange="prewievFileHandler(this,4)"
            />
          </div>
          <div class="image-upload-box">
            <img src="/img/upload.svg" class="upload-preview" id="image-section-5" />
            <input
              type="file"
              name="productImages"
              class="image-upload-input image-five"
              accept="image/jpeg,image/jpg,image/png"
              onchange="prewievFileHandler(this,5)"
            />
          </div>
        </div>
      </div>

      <input name="productStatus" value="PAUSE" class="product-status" hidden />

      <!-- Panel Footer -->
      <div class="panel-footer">
        <button type="button" class="btn-cancel" id="cancel-form-btn">Cancel</button>
        <button type="submit" class="btn-save">Save Product</button>
      </div>
    </form>
  </div>

  <script type="text/javascript" src="/js/product.js"></script>
</body>

<%- include('includes/footer') %>
